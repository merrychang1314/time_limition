# 手机时间限制器 - 安装和使用指南

## 概述

手机时间限制器是一个帮助用户控制手机使用时间的应用程序。当设定的使用时间结束后，只有通话功能可用，其他应用将被限制使用。

## 功能特点

- ⏰ 自定义使用时间限制（5-180分钟）
- 📱 时间到后只允许使用通话功能
- 🔔 提前警告提醒（1-15分钟可调）
- 🔒 密码保护，防止随意解除限制
- 📊 直观的时间显示和进度条
- ⚙️ 丰富的设置选项

## 系统要求

### 桌面版本
- Python 3.7 或更高版本
- Windows 10/11, macOS 10.14+, 或 Linux

### Android版本
- Android 5.0 (API 21) 或更高版本
- 约 20MB 存储空间

## 安装方法

### 方法一：直接安装APK（推荐）

1. 下载预编译的APK文件
2. 在Android设备上启用"未知来源"安装
   - 设置 → 安全 → 未知来源 → 开启
3. 安装APK文件
4. 首次运行时授予必要权限

### 方法二：从源码构建

#### 准备环境

1. 安装Python 3.7+
```bash
# Windows
从 python.org 下载安装

# macOS
brew install python3

# Ubuntu/Debian
sudo apt update
sudo apt install python3 python3-pip
```

2. 安装构建工具
```bash
# 安装Buildozer（用于Android构建）
pip install buildozer

# 安装Cython（构建依赖）
pip install cython

# 安装其他依赖
pip install -r requirements.txt
```

#### 构建APK

1. 运行构建脚本
```bash
python build_android.py
```

2. 选择构建选项
   - 选择 "1" 构建调试版APK
   - 选择 "2" 构建发布版APK

3. 等待构建完成（首次构建可能需要30-60分钟）

4. 生成的APK文件位于 `bin/` 目录

#### 桌面版运行

```bash
# 直接运行
python phone_time_limiter_enhanced.py

# 或使用批处理文件（Windows）
run_app.bat
```

## 权限说明

应用需要以下权限才能正常工作：

### 必需权限
- **电话权限** (`CALL_PHONE`): 允许拨打电话
- **系统窗口权限** (`SYSTEM_ALERT_WINDOW`): 显示系统级提醒
- **修改系统设置** (`WRITE_SETTINGS`): 调整系统设置

### 可选权限
- **设备管理员权限**: 用于严格模式下限制应用使用
- **通知权限**: 显示时间提醒通知

## 使用指南

### 首次设置

1. 启动应用
2. 点击"设置"按钮
3. 配置以下选项：
   - **使用时间限制**: 设置允许使用手机的时间（默认30分钟）
   - **提前警告时间**: 设置提前多久开始警告（默认5分钟）
   - **管理密码**: 设置解除限制的密码（默认1234）
   - **自动开始**: 是否启动时自动开始计时
   - **严格模式**: 是否完全禁用其他应用（需要设备管理员权限）

4. 点击"保存"保存设置

### 日常使用

1. **开始限时**
   - 点击"开始限时"按钮开始计时
   - 应用会显示剩余时间和进度条

2. **暂停/继续**
   - 计时过程中可以暂停和继续
   - 暂停时计时器停止，继续时恢复计时

3. **时间警告**
   - 在设定的警告时间前会弹出提醒
   - 提醒用户准备结束当前活动

4. **限制模式**
   - 时间到后进入限制模式
   - 只能使用通话相关功能
   - 其他应用按钮变灰或隐藏

5. **解除限制**
   - 在限制模式下点击被禁用的应用
   - 输入正确的管理密码
   - 成功后解除所有限制

### 紧急情况

即使在限制模式下，以下功能始终可用：
- 拨打电话
- 紧急联系人（110, 119, 120, 122）
- 接听来电

## 高级功能

### 严格模式

启用严格模式后：
- 需要设备管理员权限
- 完全隐藏或禁用非通话应用
- 更难被绕过或关闭

### 自定义应用列表

可以修改 `phone_time_limiter_enhanced.py` 中的应用列表：

```python
self.apps = [
    PhoneApp("电话", is_call_related=True, category="通讯"),
    PhoneApp("你的应用", is_call_related=False, category="自定义"),
    # 添加更多应用...
]
```

### 密码安全

- 建议使用复杂密码
- 定期更换密码
- 不要与他人分享密码

## 故障排除

### 常见问题

**Q: 应用无法限制其他应用？**
A: 
- 确保已授予所有必要权限
- 启用设备管理员权限
- 在设置中开启严格模式

**Q: 时间到了但限制没有生效？**
A: 
- 检查应用是否在后台运行
- 重启应用
- 检查系统权限设置

**Q: 忘记管理密码怎么办？**
A: 
- 卸载并重新安装应用（会丢失设置）
- 或修改配置文件 `limiter_config.json`

**Q: 构建APK失败？**
A: 
- 检查Python版本（需要3.7+）
- 确保安装了所有依赖
- 检查网络连接（构建过程需要下载组件）
- 查看详细错误信息

### 日志和调试

桌面版运行时会在控制台显示详细日志，包括：
- 权限请求状态
- 应用阻止/解除状态
- 错误信息

## 技术支持

如果遇到问题：

1. 查看本文档的故障排除部分
2. 检查应用日志输出
3. 确认系统版本和权限设置
4. 尝试重新安装应用

## 开发信息

- **开发语言**: Python + Kivy
- **支持平台**: Android, Windows, macOS, Linux
- **最低Android版本**: 5.0 (API 21)
- **构建工具**: Buildozer

## 更新日志

### v1.0.0
- 初始版本发布
- 基本时间限制功能
- 通话功能保留
- 密码保护
- 设置界面

## 许可证

本项目采用 MIT 许可证，详见 LICENSE 文件。

## 免责声明

本应用仅用于帮助用户自我管理手机使用时间。在紧急情况下，请确保能够正常使用通话功能。开发者不对因使用本应用而导致的任何问题承担责任。